/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'java-library'
}

group = 'at.ac.tuwien.infosys.dslab'
version = '2020'

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}


tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

def dslabRunTasks = [
        [name: 'run-server', main: 'server.Server', description: 'Run Server.', args: ''],
        [name: 'run-client1', main: 'client.Client', description: 'Run 1st client.', args: 'client1'],
        [name: 'run-client2', main: 'client.Client', description: 'Run 2nd client.', args: 'client2']
]

for (t in dslabRunTasks) {
    def taskName = t['name']

    task "$taskName"(dependsOn: 'classes', type: JavaExec) {
        main = t['main']
        args t['args']
        description = t['description']

        classpath = sourceSets.main.runtimeClasspath
        // https://discuss.gradle.org/t/why-doesnt-system-in-read-block-when-im-using-gradle/3308
        standardInput = System.in
    }
}

task zip(type: Zip) {
    from projectDir
    exclude 'build/'
    exclude '.gradle/'
    archiveFileName.set(rootProject.name + ".zip")
    destinationDirectory.set(file('build/'))
}
